<!DOCTYPE html>
<html lang="ru" id="htmlTag">

<head>

  <meta charset="utf-8" />
  <title>Quoridor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/css/style.css?v=1.0.1" type="text/css" />
  <link rel="stylesheet" href="/css/auth.css?v=1.0.1" type="text/css" />
  <link rel="stylesheet" href="/css/profile.css?v=1.0.1" type="text/css" />
</head>

<body>

  <!-- LOADING SCREEN -->
  <div id="loadingScreen">
    <div class="loading-content">
      <div class="spinner"></div>
      <h2 class="loading-text">Loading...</h2>
      <div id="loadingError" class="hidden">
        <p>Something went wrong or loading is too slow.</p>
        <button onclick="location.reload()" class="primary-btn">Reload Page</button>
      </div>
    </div>
  </div>

  <div id="userProfileArea" class="user-profile-bar">
    <button id="authBtn" class="auth-btn" onclick="UI.openAuthModal()">üîë <span class="btn-text">Login</span></button>
    <div id="userInfo" class="user-info hidden" onclick="UI.openMyProfile()">
      <div class="avatar-circle">
        <img id="userAvatarImg" src="https://ui-avatars.com/api/?name=User&background=333&color=fff" alt="Avatar">
      </div>
      <span id="userNameDisplay">User</span>
    </div>
  </div>

  <div id="mainMenu" class="screen">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (–Ω–∞–¥ –ø–æ–ª–µ–º) -->
    <h1 class="main-title mobile-only">Quoridor</h1>

    <div class="menu-layout">
      <!-- –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –¥–æ—Å–∫–∞ —Å –¥–µ–º–æ-–ø–∞—Ä—Ç–∏–µ–π -->
      <div class="board-preview">
        <div class="demo-board-container">
          <div class="player-bar demo-player-bar top">
            <div class="avatar-container">
              <div class="avatar"></div>
            </div>
            <div class="player-info">
              <span class="player-name" data-i18n="pname_opponent">–û–ø–ø–æ–Ω–µ–Ω—Ç</span>
            </div>
          </div>

          <canvas id="demoBoard" width="720" height="720"></canvas>

          <div class="player-bar demo-player-bar bottom">
            <div class="avatar-container">
              <div class="avatar"></div>
            </div>
            <div class="player-info">
              <span class="player-name" data-i18n="pname_you">–í—ã</span>
            </div>
          </div>
        </div>
      </div>

      <!-- –ü–∞–Ω–µ–ª—å –º–µ–Ω—é -->
      <div class="menu-panel">
        <h1 class="main-title desktop-only">Quoridor</h1>

        <div class="menu-buttons">
          <div id="playOnlineContainer">
            <button id="playRankedBtn" onclick="UI.quickMatch(true)" data-i18n="menu_play_ranked" class="primary-btn"
              style="margin-bottom: 10px; background-color: #e09f3e; color: #000;">üèÜ –ò–≥—Ä–∞—Ç—å –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥</button>
            <button id="playOnlineBtn" onclick="UI.quickMatch(false)" data-i18n="menu_play_online">‚ö° –ë—ã—Å—Ç—Ä—ã–π
              –ø–æ–∏—Å–∫</button>

            <button id="cancelSearchBtn" class="hidden" onclick="UI.hideSearch(false); Net.cancelFindGame()">
              <span data-i18n="menu_cancel_search">–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫</span>
              <span id="searchTimer">0:00</span>
            </button>
          </div>
          <button id="playFriendBtn" onclick="UI.showDynamicPanel('panelRoom')" data-i18n="menu_play_friend">üë• –ò–≥—Ä–∞—Ç—å —Å
            –¥—Ä—É–≥–æ–º</button>
          <button onclick="UI.showDynamicPanel('panelMode')" data-i18n="menu_local_game">üéÆ –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞</button>
          <button onclick="UI.showDynamicPanel('panelRules')" data-i18n="menu_rules">üìñ –ü—Ä–∞–≤–∏–ª–∞</button>
          <button onclick="UI.showDynamicPanel('panelSettings')" data-i18n="menu_settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>
      </div>

      <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–∞–Ω–µ–ª—å (–º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ –∏ –∏–Ω—Ñ–æ) -->
      <div class="dynamic-panel empty" id="dynamicPanel">
        <button class="close-panel-btn" onclick="UI.hideDynamicPanel()">√ó</button>
        <!-- –û–≤–µ—Ä–ª–µ–π –ø–æ–∏—Å–∫–∞ –∏–≥—Ä—ã -->
        <div id="searchOverlay" class="search-overlay hidden">
          <div class="search-spinner"></div>
          <p data-i18n="menu_searching">–ü–æ–∏—Å–∫ –∏–≥—Ä—ã...</p>
        </div>



        <!-- –ü–∞–Ω–µ–ª—å: –ò–≥—Ä–∞ —Å –¥—Ä—É–≥–æ–º -->
        <div id="panelRoom" class="dynamic-content hidden">
          <h3 data-i18n="screen_room_title">–ò–≥—Ä–∞ —Å –¥—Ä—É–≥–æ–º</h3>
          <div class="room-section">
            <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞, —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
            <button class="primary-btn hidden" id="createRoomBtn" onclick="UI.createPrivateRoom()"
              data-i18n="btn_create_room">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>

            <div id="roomCodeDisplay" class="hidden">
              <p data-i18n="room_created_msg">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã —Å–æ–∑–¥–∞–Ω! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –¥—Ä—É–≥—É:</p>
              <div class="code-box">
                <span id="roomCodeValue">XXXXX</span>
                <button class="copy-btn" onclick="UI.copyRoomCode()" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å">üìã</button>
              </div>

              <div class="link-box">
                <p class="link-label" data-i18n="label_copy_link">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å:</p>
                <div class="link-value" id="roomLinkDisplay" onclick="UI.copyRoomLink()">http://...</div>
              </div>

              <p class="room-hint" data-i18n="room_waiting">–û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...</p>
            </div>
          </div>
          <div class="separator-line" data-i18n="label_or">–∏–ª–∏</div>
          <div class="room-section">
            <div class="room-join-group">
              <input type="text" id="roomCodeInput" maxlength="5" placeholder="CODE" class="room-code-input"
                oninput="UI.validateRoomInput(this)">
              <button class="secondary-btn disabled" id="joinRoomBtn" onclick="UI.joinPrivateRoom()"
                data-i18n="btn_join_room" disabled>–í–æ–π—Ç–∏</button>
            </div>
          </div>
        </div>

        <!-- Panel Admin (Bots) -->
        <div id="panelAdmin" class="dynamic-content hidden" style="text-align: left;">
          <h3 style="color:red;">ü§ñ Admin Bot Control</h3>
          <div class="admin-controls"
            style="display:flex; flex-direction:column; gap:10px; padding:10px; background:rgba(0,0,0,0.3); border-radius:8px;">
            <label>Difficulty:
              <select id="botDifficulty" style="background:#333; color:#fff; padding:5px;">
                <option value="easy">Easy</option>
                <option value="medium" selected>Medium</option>
                <option value="hard">Hard</option>
                <option value="impossible">Impossible</option>
              </select>
            </label>
            <label><input type="checkbox" id="botRanked"> Ranked Match</label>
            <button onclick="UI.spawnBot()" class="primary-btn" style="background: #e09f3e; color: #000;">Spawn
              Bot</button>
          </div>
          <div class="bot-list-container" style="margin-top:15px;">
            <h4>Active Bots</h4>
            <div id="activeBotList" style="max-height:150px; overflow-y:auto; background:rgba(0,0,0,0.2); padding:5px;">
              Loading...</div>
            <button onclick="UI.refreshBotList()" class="secondary-btn" style="margin-top:5px; font-size:12px;">Refresh
              List</button>
          </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å: –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞ -->
        <div id="panelMode" class="dynamic-content hidden">
          <h3 data-i18n="screen_mode_title">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º</h3>
          <div class="panel-buttons">
            <button onclick="Game.startPvP()" data-i18n="mode_pvp">–î–≤–∞ –∏–≥—Ä–æ–∫–∞ (PvP)</button>
            <div class="separator-line" data-i18n="mode_bot_title">–ò–≥—Ä–∞ —Å –±–æ—Ç–æ–º</div>
            <button onclick="UI.selectBotDifficulty('easy')" data-i18n="mode_bot_easy">–õ–µ–≥–∫–∏–π –±–æ—Ç</button>
            <button onclick="UI.selectBotDifficulty('medium')" data-i18n="mode_bot_medium">–°—Ä–µ–¥–Ω–∏–π –±–æ—Ç</button>
            <button onclick="UI.selectBotDifficulty('hard')" data-i18n="mode_bot_hard">–°–∏–ª—å–Ω—ã–π –±–æ—Ç</button>
            <button onclick="UI.selectBotDifficulty('impossible')" data-i18n="mode_bot_impossible">–ù–µ–ø–æ–±–µ–¥–∏–º—ã–π
              –±–æ—Ç</button>

          </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å: –ü—Ä–∞–≤–∏–ª–∞ -->
        <div id="panelRules" class="dynamic-content hidden">
          <h3 data-i18n="screen_rules_title">–ü—Ä–∞–≤–∏–ª–∞</h3>
          <div class="rules-content-inline">
            <div class="rules-section">
              <h4 data-i18n="rules_goal_title">üéØ –¶–µ–ª—å</h4>
              <p data-i18n="rules_goal_text">–ü–µ—Ä–≤—ã–º –¥–æ–≤–µ–¥–∏—Ç–µ —Å–≤–æ—é —Ñ–∏—à–∫—É –¥–æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –∫—Ä–∞—è –¥–æ—Å–∫–∏.</p>
            </div>
            <div class="rules-section">
              <h4 data-i18n="rules_turn_title">üé≤ –•–æ–¥</h4>
              <p data-i18n="rules_turn_text">–ó–∞ —Ö–æ–¥ –º–æ–∂–Ω–æ: –ø–µ—Ä–µ–¥–≤–∏–Ω—É—Ç—å —Ñ–∏—à–∫—É –Ω–∞ 1 –∫–ª–µ—Ç–∫—É –∏–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–µ–Ω—É.</p>
            </div>
            <div class="rules-section">
              <h4 data-i18n="rules_jump_title">üö∂ –ü—Ä—ã–∂–∫–∏</h4>
              <p data-i18n="rules_jump_text">–ï—Å–ª–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫ —Ä—è–¥–æ–º ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø—Ä—ã–≥–Ω—É—Ç—å —á–µ—Ä–µ–∑ –Ω–µ–≥–æ.</p>
            </div>
            <div class="rules-section">
              <h4 data-i18n="rules_wall_title">üß± –°—Ç–µ–Ω—ã</h4>
              <p data-i18n="rules_wall_text">–°—Ç–µ–Ω–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 2 –∫–ª–µ—Ç–∫–∏. –ù–µ–ª—å–∑—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç—å –∫ —Ü–µ–ª–∏.</p>
            </div>
            <div class="rules-section">
              <h4 data-i18n="rules_controls_title">‚å®Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h4>
              <p data-i18n="rules_controls_text"><kbd>H</kbd> ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞, <kbd>V</kbd> ‚Äî –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è,
                <kbd>R</kbd> ‚Äî –ø–æ–≤–µ—Ä–Ω—É—Ç—å.
              </p>
            </div>
          </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="panelSettings" class="dynamic-content hidden">
          <h3 data-i18n="screen_settings_title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
          <div class="settings-grid-inline">
            <label data-i18n="label_theme">–¢–µ–º–∞:</label>
            <select id="themeSelectInline">
              <option value="dark" data-i18n="theme_dark">–¢—ë–º–Ω–∞—è</option>
              <option value="light" data-i18n="theme_light">–°–≤–µ—Ç–ª–∞—è</option>
            </select>
            <label data-i18n="label_lang">–Ø–∑—ã–∫:</label>
            <select id="langSelectInline">
              <option value="ru">–†—É—Å—Å–∫–∏–π</option>
              <option value="en">English</option>
            </select>
            <label data-i18n="label_sound">–ó–≤—É–∫:</label>
            <select id="soundSelectInline">
              <option value="on" data-i18n="sound_on">–í–∫–ª</option>
              <option value="off" data-i18n="sound_off">–í—ã–∫–ª</option>
            </select>
          </div>
          <button class="primary-btn" onclick="UI.saveSettingsInline()" data-i18n="btn_save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div> <!-- Close dynamicPanel -->

      <!-- –ò–Ω—Ñ–æ-–ø–∞–Ω–µ–ª—å —Å–ø—Ä–∞–≤–∞ (–°–æ–≤–µ—Ç—ã –∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥) -->
      <div class="info-panel" id="infoPanel">
        <div class="info-card">
          <div class="info-card-header">
            <span class="info-icon">üí°</span>
            <h3 data-i18n="info_tip_title">–°–æ–≤–µ—Ç –¥–Ω—è</h3>
          </div>
          <p id="dailyTip" data-i18n="info_tip_text">–°—Ç–µ–Ω—ã ‚Äî –≤–∞—à–µ –≥–ª–∞–≤–Ω–æ–µ –æ—Ä—É–∂–∏–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö, —á—Ç–æ–±—ã —É–¥–ª–∏–Ω–∏—Ç—å
            –ø—É—Ç—å
            —Å–æ–ø–µ—Ä–Ω–∏–∫–∞, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ —Å–µ–±—è!</p>
        </div>
        <div class="info-card">
          <div class="info-card-header">
            <span class="info-icon">üèÜ</span>
            <h3 data-i18n="info_leaderboard_title">–õ–∏–¥–µ—Ä–±–æ—Ä–¥</h3>
          </div>
          <div class="leaderboard" id="leaderboard">
            <div class="leaderboard-row loading">Loading...</div>
          </div>
          <p class="info-hint" data-i18n="info_hint">–†–µ–π—Ç–∏–Ω–≥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>
      </div> <!-- info-panel -->
      <div class="app-version">v1.01</div>
    </div> <!-- menu-layout -->
  </div> <!-- mainMenu -->


  <div id="modeScreen" class="screen">
    <h2 data-i18n="screen_mode_title">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º</h2>
    <div class="mode-buttons">
      <button onclick="Game.startPvP()" data-i18n="mode_pvp">–î–≤–∞ –∏–≥—Ä–æ–∫–∞ (PvP)</button>

      <div class="separator-line" data-i18n="mode_bot_title">–ò–≥—Ä–∞ —Å –±–æ—Ç–æ–º</div>

      <button onclick="UI.selectBotDifficulty('easy')" data-i18n="mode_bot_easy">–õ–µ–≥–∫–∏–π –±–æ—Ç</button>
      <button onclick="UI.selectBotDifficulty('medium')" data-i18n="mode_bot_medium">–°—Ä–µ–¥–Ω–∏–π –±–æ—Ç</button>
      <button onclick="UI.selectBotDifficulty('hard')" data-i18n="mode_bot_hard">–°–∏–ª—å–Ω—ã–π –±–æ—Ç</button>
      <button onclick="UI.selectBotDifficulty('impossible')" data-i18n="mode_bot_impossible">–ù–µ–ø–æ–±–µ–¥–∏–º—ã–π
        –±–æ—Ç</button>
    </div>
    <button onclick="UI.backToMenu()" data-i18n="btn_back">–ù–∞–∑–∞–¥</button>
  </div>

  <div id="colorSelectScreen" class="screen">
    <h2 data-i18n="screen_color_title">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–æ—Ä–æ–Ω—É</h2>
    <p data-i18n="color_white_hint">–ë–µ–ª—ã–µ –≤—Å–µ–≥–¥–∞ —Ö–æ–¥—è—Ç –ø–µ—Ä–≤—ã–º–∏</p>
    <div class="menu-buttons horizontal">
      <button onclick="Game.startVsBot('white')" data-i18n="btn_play_white">
        ‚ö™ –ò–≥—Ä–∞—Ç—å –∑–∞ –ë–µ–ª—ã—Ö<br>(–í—ã —Ö–æ–¥–∏—Ç–µ –ø–µ—Ä–≤—ã–º)
      </button>
      <button onclick="Game.startVsBot('black')" data-i18n="btn_play_black">
        ‚ö´ –ò–≥—Ä–∞—Ç—å –∑–∞ –ß—ë—Ä–Ω—ã—Ö<br>(–ë–æ—Ç —Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–º)
      </button>
    </div>
    <button onclick="UI.showModeSelect()" data-i18n="btn_back">–ù–∞–∑–∞–¥</button>
  </div>

  <!-- PROFILE SCREEN (NEW) -->
  <div id="profileScreen" class="screen">
    <div class="profile-page-container">
      <button class="btn-back-floating" onclick="UI.backToMenuFromProfile()">‚Üê Back</button>

      <!-- Header -->
      <div class="profile-page-header">
        <div class="pp-avatar-section">
          <img id="ppAvatar" class="pp-avatar" src="https://ui-avatars.com/api/?name=User" alt="User Avatar">
          <div class="pp-country-flag" id="ppFlag" title="Country">üåç</div>
        </div>
        <div class="pp-info-section">
          <h1 id="ppUsername">User</h1>
          <p id="ppBio" class="pp-bio">No bio description yet.</p>
          <p class="pp-joined">Joined: <span id="ppJoinedDate">--/--/----</span></p>
        </div>
        <div class="pp-actions" id="ppActions">
          <!-- Buttons injected by JS (e.g. Add Friend, Edit Profile) -->
        </div>
      </div>

      <!-- Stats Overview -->
      <div class="pp-stats-overview">
        <div class="pp-stat-card">
          <div class="label">Games</div>
          <div class="value" id="ppTotalGames">0</div>
        </div>
        <div class="pp-stat-card">
          <div class="label">W/L</div>
          <div class="value" id="ppWins">0</div>
        </div>
        <div class="pp-stat-card">
          <div class="label">Winrate</div>
          <div class="value" id="ppWinrate">0%</div>
        </div>
        <div class="pp-stat-card rating">
          <div class="label">Rating</div>
          <div class="value" id="ppRating">1200</div>
        </div>
        <!-- Hidden internal stats for calculations -->
        <span id="ppLosses" class="hidden">0</span>
      </div>

      <!-- Tabs -->
      <div class="pp-tabs">
        <button class="pp-tab active" onclick="UI.switchProfileTab('history', this)">History</button>
        <button class="pp-tab" onclick="UI.switchProfileTab('friends', this)">Friends</button>
      </div>

      <!-- Tab Content: History -->
      <div id="ppTabHistory" class="pp-tab-content active">
        <div class="pp-history-scroll-area">
          <table class="pp-history-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Opponent</th>
                <th>Result</th>
                <th>Rating</th>
                <th>Moves</th>
              </tr>
            </thead>
            <tbody id="ppHistoryBody">
              <!-- Injected -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Tab Content: Friends -->
      <div id="ppTabFriends" class="pp-tab-content">
        <div style="padding: 20px; text-align: center; color: #888;">
          <p>Friends system coming soon!</p>
        </div>
      </div>
    </div>
  </div>

  <div id="roomScreen" class="screen">
    <h2 data-i18n="screen_room_title">–ò–≥—Ä–∞ —Å –¥—Ä—É–≥–æ–º</h2>
    <div class="mode-buttons">
      <!-- –ë–ª–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è -->
      <div class="room-section">
        <button class="primary-btn" id="createRoomBtn" onclick="UI.createPrivateRoom()"
          data-i18n="btn_create_room">–°–æ–∑–¥–∞—Ç—å
          –∫–æ–º–Ω–∞—Ç—É</button>
        <div id="roomCodeDisplay" class="hidden">
          <p data-i18n="room_created_msg">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã —Å–æ–∑–¥–∞–Ω! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –¥—Ä—É–≥—É:</p>
          <div class="code-box">
            <span id="roomCodeValue">XXXXX</span>
            <button class="copy-btn" onclick="UI.copyRoomCode()" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å">üìã</button>
          </div>
          <p class="room-hint" data-i18n="room_waiting">–û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞...</p>
        </div>
      </div>

      <div class="separator-line" data-i18n="label_or">–∏–ª–∏</div>

      <!-- –ë–ª–æ–∫ –≤—Ö–æ–¥–∞ -->
      <div class="room-section">
        <div class="room-join-group">
          <input type="text" id="roomCodeInputOld" maxlength="5" placeholder="CODE"
            style="text-transform: uppercase; text-align: center; font-size: 1.5rem; width: 140px; margin-right: 10px; border-radius: 8px; border: 2px solid #444; background: #222; color: #fff; padding: 10px;">
          <button class="secondary-btn" id="joinRoomBtn" onclick="UI.joinPrivateRoom()"
            data-i18n="btn_join_room">–í–æ–π—Ç–∏</button>
        </div>
      </div>

      <button onclick="UI.backToMenu()" data-i18n="btn_back">–ù–∞–∑–∞–¥</button>
    </div>
  </div>
  <div id="gameScreen" class="screen">
    <div class="game-layout">

      <div class="board-area">

        <div class="player-bar" id="topPlayerBar">
          <div class="avatar-container">
            <img class="avatar" id="topPlayerAvatar" src="https://ui-avatars.com/api/?name=?&background=333&color=fff"
              alt="Avatar">
          </div>
          <div class="player-info">
            <div class="player-name-row">
              <span class="player-name" id="topPlayerName" data-i18n="pname_opponent">–û–ø–ø–æ–Ω–µ–Ω—Ç</span>
            </div>
          </div>
          <div class="timer" id="topPlayerTimer">10:00</div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç–µ–Ω –æ–ø–ø–æ–Ω–µ–Ω—Ç–∞ -->
        <div class="wall-inventory" id="topWallInventory"></div>

        <div id="game-container">
          <canvas id="board" width="1080" height="1080"></canvas>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∏—Ö —Å—Ç–µ–Ω (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ) -->
        <div class="wall-inventory" id="bottomWallInventory"></div>

        <div class="player-bar" id="bottomPlayerBar">
          <div class="avatar-container">
            <img class="avatar" id="bottomPlayerAvatar"
              src="https://ui-avatars.com/api/?name=?&background=333&color=fff" alt="Avatar">
          </div>
          <div class="player-info">
            <div class="player-name-row">
              <span class="player-name" id="bottomPlayerName" data-i18n="pname_you">–í—ã</span>
            </div>
          </div>
          <div class="timer" id="bottomPlayerTimer">10:00</div>
        </div>

      </div>

      <!-- –°–∞–π–¥–±–∞—Ä –¥–ª—è –±—É–¥—É—â–µ–π –∏—Å—Ç–æ—Ä–∏–∏ —Ö–æ–¥–æ–≤ -->
      <div class="sidebar">
        <div class="sidebar-content">
          <div class="history-container-wrapper">
            <!-- –®–∞–±–ª–æ–Ω –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —Å—Ç–µ–Ω—ã -->
            <div class="wall-template v" id="wallTemplateV" title="–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞"></div>

            <div id="moveHistory">
              <div class="history-header">
                <span data-i18n="pname_white">White</span>
                <span data-i18n="pname_black">Black</span>
              </div>
              <div class="history-list" id="historyList"></div>
              <div class="history-controls">
                <button id="histFirst" title="–í –Ω–∞—á–∞–ª–æ" onclick="Game.setHistoryView(0)">¬´</button>
                <button id="histPrev" title="–ù–∞–∑–∞–¥" onclick="Game.navigateHistory(-1)">‚Äπ</button>
                <button id="histNext" title="–í–ø–µ—Ä–µ–¥" onclick="Game.navigateHistory(1)">‚Ä∫</button>
                <button id="histLast" title="–í –∫–æ–Ω–µ—Ü" onclick="Game.setHistoryView(-1)">¬ª</button>
              </div>
            </div>

            <!-- –®–∞–±–ª–æ–Ω –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å—Ç–µ–Ω—ã -->
            <div class="wall-template h" id="wallTemplateH" title="–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç–µ–Ω–∞"></div>
          </div>
        </div>
        <div class="menu-actions">
          <button class="secondary-btn" onclick="UI.handleSurrender()" data-i18n="btn_surrender">–°–¥–∞—Ç—å—Å—è</button>
        </div>
      </div>

    </div>
  </div>

  <div id="settingsScreen" class="screen">
    <h2 data-i18n="screen_settings_title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
    <div class="settings-grid">
      <label data-i18n="label_theme">–¢–µ–º–∞:</label>
      <select id="themeSelect">
        <option value="dark" data-i18n="theme_dark">–¢—ë–º–Ω–∞—è</option>
        <option value="light" data-i18n="theme_light">–°–≤–µ—Ç–ª–∞—è</option>
      </select>

      <label data-i18n="label_lang">–Ø–∑—ã–∫:</label>
      <select id="langSelect">
        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
        <option value="en">English</option>
      </select>

      <label data-i18n="label_sound">–ó–≤—É–∫:</label>
      <select id="soundSelect">
        <option value="on" data-i18n="sound_on">–í–∫–ª</option>
        <option value="off" data-i18n="sound_off">–í—ã–∫–ª</option>
      </select>
    </div>
    <br>
    <button onclick="UI.saveSettings()" data-i18n="btn_save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button onclick="UI.backToMenu()" data-i18n="btn_back">–ù–∞–∑–∞–¥</button>
  </div>

  <div id="rulesScreen" class="screen">
    <div class="rules-header">
      <h2 data-i18n="screen_rules_title">–ü—Ä–∞–≤–∏–ª–∞</h2>
    </div>

    <div class="rules-content" id="rulesContentRu">
      <div class="rules-section">
        <h3>üéØ –¶–µ–ª—å</h3>
        <p>–ü–µ—Ä–≤—ã–º –¥–æ–≤–µ–¥–∏—Ç–µ —Å–≤–æ—é —Ñ–∏—à–∫—É –¥–æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –∫—Ä–∞—è –¥–æ—Å–∫–∏.</p>
      </div>

      <div class="rules-section">
        <h3>üé≤ –•–æ–¥</h3>
        <p>–ë–µ–ª—ã–µ —Ö–æ–¥—è—Ç –ø–µ—Ä–≤—ã–º–∏. –ó–∞ —Ö–æ–¥ –º–æ–∂–Ω–æ:</p>
        <ul>
          <li>–ü–µ—Ä–µ–¥–≤–∏–Ω—É—Ç—å —Ñ–∏—à–∫—É –Ω–∞ 1 –∫–ª–µ—Ç–∫—É (–Ω–µ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏)</li>
          <li>–ü–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–µ–Ω—É (—É –≤–∞—Å 10 —Å—Ç–µ–Ω)</li>
        </ul>
      </div>

      <div class="rules-section">
        <h3>üö∂ –ü—Ä—ã–∂–∫–∏</h3>
        <p>–ï—Å–ª–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫ —Å—Ç–æ–∏—Ç —Ä—è–¥–æ–º ‚Äî –º–æ–∂–Ω–æ –ø–µ—Ä–µ–ø—Ä—ã–≥–Ω—É—Ç—å —á–µ—Ä–µ–∑ –Ω–µ–≥–æ. –ï—Å–ª–∏ –∑–∞ –Ω–∏–º —Å—Ç–µ–Ω–∞ ‚Äî –ø—Ä—ã–∂–æ–∫ –≤–±–æ–∫.</p>
      </div>

      <div class="rules-section">
        <h3>üß± –°—Ç–µ–Ω—ã</h3>
        <p>–°—Ç–µ–Ω–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 2 –∫–ª–µ—Ç–∫–∏. –ù–µ–ª—å–∑—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç—å –∫ —Ü–µ–ª–∏.</p>
      </div>

      <div class="rules-section">
        <h3>‚å®Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
        <ul>
          <li><kbd>H</kbd> ‚Äî –≤–∑—è—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é —Å—Ç–µ–Ω—É</li>
          <li><kbd>V</kbd> ‚Äî –≤–∑—è—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é —Å—Ç–µ–Ω—É</li>
          <li><kbd>R</kbd> ‚Äî –ø–æ–≤–µ—Ä–Ω—É—Ç—å —Å—Ç–µ–Ω—É</li>
          <li><kbd>Esc</kbd> ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å</li>
        </ul>
      </div>
    </div>

    <div class="rules-content hidden" id="rulesContentEn">
      <div class="rules-section">
        <h3>üéØ Goal</h3>
        <p>Be the first to reach the opposite edge of the board.</p>
      </div>

      <div class="rules-section">
        <h3>üé≤ Turn</h3>
        <p>White moves first. On your turn you can:</p>
        <ul>
          <li>Move your pawn 1 square (not diagonally)</li>
          <li>Place a wall (you have 10 walls)</li>
        </ul>
      </div>

      <div class="rules-section">
        <h3>üö∂ Jumps</h3>
        <p>If the opponent is adjacent ‚Äî jump over them. If blocked by a wall ‚Äî jump diagonally.</p>
      </div>

      <div class="rules-section">
        <h3>üß± Walls</h3>
        <p>Each wall covers 2 squares. You cannot completely block the path to the goal.</p>
      </div>

      <div class="rules-section">
        <h3>‚å®Ô∏è Controls</h3>
        <ul>
          <li><kbd>H</kbd> ‚Äî pick horizontal wall</li>
          <li><kbd>V</kbd> ‚Äî pick vertical wall</li>
          <li><kbd>R</kbd> ‚Äî rotate wall</li>
          <li><kbd>Esc</kbd> ‚Äî cancel</li>
        </ul>
      </div>
    </div>

    <button onclick="UI.backToMenu()" data-i18n="btn_back">–ù–∞–∑–∞–¥</button>
  </div>



  <div id="resultModal" class="modal-overlay hidden">
    <div class="modal-content">
      <h2 id="resultStatus" data-i18n="modal_win">–ü–û–ë–ï–î–ê</h2>
      <p class="result-reason">
        <span data-i18n="modal_reason">–ü—Ä–∏—á–∏–Ω–∞: </span>
        <span id="resultReasonText"></span>
      </p>

      <div id="resultRatingChanges" class="rating-changes"></div>

      <div class="result-actions">
        <button class="primary-btn" onclick="Game.goToMainMenu()" data-i18n="btn_to_menu">–í –º–µ–Ω—é</button>
      </div>
    </div>
  </div>

  <!-- Disconnect Overlay -->
  <div id="disconnectModal" class="disconnect-overlay hidden">
    <div class="disconnect-content">
      <div class="disconnect-title" data-i18n="disconnect_title">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ</div>
      <div class="disconnect-msg" data-i18n="disconnect_msg">
        –í—ã –æ—Ç–∫—Ä—ã–ª–∏ –∏–≥—Ä—É –≤ –¥—Ä—É–≥–æ–π –≤–∫–ª–∞–¥–∫–µ –∏–ª–∏ –æ–∫–Ω–µ.
        <br>–≠—Ç–∞ —Å–µ—Å—Å–∏—è –±—ã–ª–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
      </div>
      <button class="primary-btn" onclick="location.reload()" data-i18n="btn_reconnect">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∏–≥—Ä—É
        (Reconnect)</button>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirmModal" class="confirm-overlay" style="display: none;">
    <div class="confirm-box">
      <div class="confirm-title" id="confirmTitle" data-i18n="confirm_title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
      <div class="confirm-msg" id="confirmMessage" data-i18n="confirm_msg">–í—ã —É–≤–µ—Ä–µ–Ω—ã?</div>
      <div class="confirm-actions">
        <button class="primary-btn" id="confirmYes" data-i18n="btn_yes">–î–∞</button>
        <button class="secondary-btn" id="confirmNo" data-i18n="btn_no">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <div id="profileModal" class="modal-overlay hidden">
    <div class="profile-modal-content">
      <button class="close-panel-btn" onclick="UI.closeProfileModal()">√ó</button>

      <div id="panelProfile">
        <div class="profile-header">
          <div class="profile-avatar-big" onclick="UI.openAvatarPicker()">
            <img id="profileAvatarLarge" src="https://ui-avatars.com/api/?name=User&background=333&color=fff"
              alt="Large Avatar">
            <div class="avatar-edit-hint">üì∏</div>
          </div>
          <div class="profile-main-info">
            <h2 id="profileUsername">Username</h2>
            <div class="profile-status-wrapper">
              <input type="text" id="profileStatusInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Ç–∞—Ç—É—Å..." maxlength="100"
                onblur="UI.updateUserStatus()" onkeydown="if(event.key==='Enter') this.blur()">
            </div>
            <p class="join-date">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: <span id="profileRegDate">--.--.----</span></p>
          </div>
          <button class="logout-btn-profile" onclick="UI.logout()">–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã</button>
        </div>

        <div class="profile-stats-grid">
          <div class="rating-card">
            <span class="rating-label">Rating</span>
            <span class="rating-value" id="modalRating">1200</span>
          </div>
        </div>

        <div class="profile-archive">
          <h3 data-api-i18n="profile_archive_title">–ê—Ä—Ö–∏–≤ –ø–∞—Ä—Ç–∏–π</h3>
          <div class="archive-table-wrapper">
            <table id="archiveTable">
              <thead>
                <tr>
                  <th>–¢–∏–ø</th>
                  <th>–ò–≥—Ä–æ–∫–∏</th>
                  <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                  <th>–•–æ–¥—ã</th>
                  <th>–î–∞—Ç–∞</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="archiveBody">
                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="authModal" class="modal-overlay hidden">
    <div class="auth-content">
      <button class="close-panel-btn" onclick="UI.closeAuthModal()">√ó</button>

      <h2 id="authTitle" class="auth-title" data-i18n="auth_login">–í—Ö–æ–¥</h2>

      <div id="authFormContainer">
        <!-- LOGIN FORM -->
        <div id="loginForm" class="auth-form">
          <input type="text" id="loginUsername" placeholder="Username" class="auth-input">
          <input type="password" id="loginPassword" placeholder="Password" class="auth-input">
          <div class="auth-fp-wrapper">
            <a href="#" class="auth-link small" onclick="return false;" style="opacity: 0.6; cursor: default;"
              data-i18n="link_forgot_pass">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
          </div>
          <div class="auth-actions">
            <button class="primary-btn full-width" onclick="UI.submitLogin()"
              data-i18n="btn_login_submit">–í–æ–π—Ç–∏</button>
          </div>
          <div class="auth-footer">
            <span class="auth-text" data-i18n="text_no_account">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?</span>
            <a href="#" class="auth-link action-link" onclick="UI.switchAuthTab('register'); return false;"
              data-i18n="link_register">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
          </div>
        </div>

        <!-- REGISTER FORM -->
        <div id="registerForm" class="auth-form hidden">
          <input type="text" id="regUsername" placeholder="Username (at least 3 characters)" class="auth-input">
          <input type="password" id="regPassword" placeholder="Password (at least 8 characters)" class="auth-input">
          <div class="auth-actions">
            <button class="primary-btn full-width" onclick="UI.submitRegister()"
              data-i18n="btn_reg_submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
          </div>
          <div class="auth-footer">
            <span class="auth-text" data-i18n="text_has_account">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</span>
            <a href="#" class="auth-link action-link" onclick="UI.switchAuthTab('login'); return false;"
              data-i18n="link_login_back">–í–æ–π—Ç–∏</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toasts Container -->
  <div id="notificationContainer" class="notification-container"></div>


  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/ui.js?v=1.0.1"></script>
  <script src="/js/net.js?v=1.0.1"></script>
  <script src="/shared.js?v=1.0.1"></script>
  <script src="/js/ai.js?v=1.0.1"></script>
  <script src="/js/game.js?v=1.0.1"></script>
</body>

</html>